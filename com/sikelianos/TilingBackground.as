package com.sikelianos {	import flash.display.*  import com.sikelianos.*  import flash.events.*	import flash.net.*  import flash.system.LoaderContext	public class TilingBackground extends Sprite {    public var _loader:Loader    public var _url:String    public var _max_width:Number    public var _max_height:Number        		function TilingBackground(url:String, max_width:Number=3000, max_height:Number=3000) {      _url = url      _max_width = max_width      _max_height = max_height		  loadImage(_url)    }    		function loadImage(url:String) {      var context = new LoaderContext();      context.checkPolicyFile = false;      _loader = new Loader();      _loader.contentLoaderInfo.addEventListener(Event.COMPLETE, layTiles)      _loader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, onIOError);      var request:URLRequest = new URLRequest(url);      _loader.load(request,context);	 	}	 	    function onIOError(e:IOErrorEvent):void{      trace(e)    }        private function duplicateImage(original:Bitmap):Bitmap {        var image:Bitmap = new Bitmap(original.bitmapData.clone());        addChild(image);        return image;    }	 		 	function layTiles(e:Event) {      var loader:Loader = Loader(e.target.loader)      var bitmap:Bitmap = Bitmap(loader.content)      var x_max = Math.round(_max_width/loader.content.width)      var y_max = Math.round(_max_height/loader.content.height)      for (var ix=0; ix<x_max; ix++) {        for (var iy=0; iy<y_max; iy++) {          var tile:Tile = new Tile(ix, iy)          var duplicate:Bitmap = new Bitmap(bitmap.bitmapData.clone())          tile.addChild(duplicate)          addChild(tile)        }      }	 	}    	}}